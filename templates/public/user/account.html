{% extends "public/user/base.html" %}

{% block title %}Account{% endblock title %}

{% block content %}

<style>
    .table-wrapper {
        max-height: 500px; /* Adjust the height as needed */
        overflow-y: auto;
    }

    .table-wrapper::-webkit-scrollbar {
        display: none;  /* Safari and Chrome */
    }

    .table {
        width: 100%;
        border-collapse: collapse;
    }

    .table thead {
        position: sticky;
        top: 0;
        background-color: #fff; /* Background color to ensure the header is visible */
        z-index: 1; /* Ensure the header stays on top of the body rows */
    }

    .table th, .table td {
        padding: 8px;
        text-align: left;
    }
</style>
    
    {% include "components/user/toast.html" %}
    {% include "components/user/header.html" %}
    {% include "components/user/cart.html" %}
    {% include "components/user/mobile.html" %}
    {% include "components/user/breadcrumb.html" with title='Account' %}

    <!-- WISHLIST AREA START -->
    <div class="liton__wishlist-area pb-70">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <!-- PRODUCT TAB AREA START -->
                    <div class="ltn__product-tab-area">
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="ltn__tab-menu-list mb-50">
                                        <div class="nav">
                                            <a class="active show" data-toggle="tab" href="#liton_tab_1_1">Dashboard <i class="fas fa-home"></i></a>
                                            <a id="#liton_tab_1_2" data-toggle="tab" href="#liton_tab_1_2">Orders <i class="fas fa-file-alt"></i></a>
                                            <a id="#liton_tab_1_3" data-toggle="tab" href="#liton_tab_1_3">Wallet <i class="fas fa-credit-card"></i></a>
                                            <a data-toggle="tab" href="#liton_tab_1_4">address <i class="fas fa-map-marker-alt"></i></a>
                                            <a data-toggle="tab" href="#liton_tab_1_5">Account Details <i class="fas fa-user"></i></a>
                                            <a href="/user/signout">Logout <i class="fas fa-sign-out-alt"></i></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-8">
                                    <div class="tab-content">
                                        <div class="tab-pane fade active show" id="liton_tab_1_1">
                                            <div class="ltn__myaccount-tab-content-inner">
                                                {% if messages %}
                                                    {% for message in messages %}
                                                        <span id="django-message" data-message="{{ message }}" data-tags="{{ message.tags }}"></span>
                                                    {% endfor %}
                                                {% endif %}
                
                                                <p>Hello <strong>{{request.user.first_name}} {{request.user.last_name}}</strong> (not <strong>{{request.user.first_name}}</strong>? <small><a href="/user/signout">Log out</a></small> )</p>
                                                <p>From your account dashboard you can view your <span>recent orders</span>, manage your <span>shipping and billing addresses</span>, and <span>edit your password and account details</span>.</p>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="liton_tab_1_2">
                                            <div class="ltn__myaccount-tab-content-inner">
                                                <div class="table-responsive table-wrapper">
                                                    <table class="table">
                                                        <thead>
                                                            <tr>
                                                                <th>Order</th>
                                                                <th>Date</th>
                                                                <th>Status</th>
                                                                <th>Total</th>
                                                                <th>Action</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            {% for order in orders %}
                                                            <tr>
                                                                <td>{{forloop.counter}}</td>
                                                                <td>{{order.created_at}}</td>
                                                                <td>{{order.statuses.last}}</td>
                                                                <td>${{order.price}}</td>
                                                                <td><a href="/orders/{{order.id}}">View</a></td>
                                                            </tr>
                                                            {% endfor %}
                                                        </tbody>
                                                    </table>
                                                    
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="liton_tab_1_3">
                                            <div class="ltn__myaccount-tab-content-inner">
                                                <div class="table-responsive table-wrapper">
                                                    <table class="table">
                                                        <thead>
                                                            <tr>
                                                                <th>Date</th>
                                                                <th>Transaction</th>
                                                                <th>Balance</th>
                                                                <th>Amount</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            {% for transaction in transactions %}
                                                            <tr>
                                                                <td>{{transaction.created_at}}</td>
                                                                <td>{{transaction.transaction}}</td>
                                                                <td>${{transaction.balance}}</td>
                                                                <td><span class="text-{% if transaction.status == 'Credit' %}success{% else %}danger{% endif %}">${{transaction.amount}}</span></td>
                                                            </tr>
                                                            {% endfor %}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="liton_tab_1_4">
                                            <div class="ltn__myaccount-tab-content-inner">
                                                <p>The following addresses will be used on the checkout page by default.</p>
                                                <div class="row">
                                                    {% for address in addresses %}
                                                    <div class="col-md-6 col-12 learts-mb-30">
                                                        <h4>{% if address.is_default %}Default Address{% else %}Address{% endif %} <small><a href="/user/address/edit/{{address.address_id.id}}">edit</a></small></h4>
                                                        <address>
                                                            <p><strong>{{address.address_id.first_name}} {{address.address_id.last_name}}</strong></p>
                                                            <p>{{address.address_id.address}}, {{address.address_id.additional}}<br>
                                                                {{address.address_id.city}}, {{address.address_id.state}}, {{address.address_id.zip_code}}<br>
                                                                {{address.address_id.country}}
                                                            </p>
                                                            <p>Mobile: {{address.address_id.phone_number}}</p>
                                                        </address>
                                                    </div>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="liton_tab_1_5">
                                            <div class="ltn__myaccount-tab-content-inner">
                                                <p>The following addresses will be used on the checkout page by default.</p>
                                                <div class="ltn__form-box">
                                                    <form method="post">
                                                        {% csrf_token %}
                                                        <div class="row mb-50">
                                                            <div class="col-md-6">
                                                                <label>First name:</label>
                                                                <input type="text" name="firstname">
                                                            </div>
                                                            <div class="col-md-6">
                                                                <label>Last name:</label>
                                                                <input type="text" name="lastname">
                                                            </div>
                                                        </div>
                                                        <fieldset>
                                                            <legend>Password change</legend>
                                                            <div class="row">
                                                                <div class="col-md-12">
                                                                    <label>Current password (leave blank to leave unchanged):</label>
                                                                    <input type="password" name="currentpassword" required>
                                                                    <label>New password (leave blank to leave unchanged):</label>
                                                                    <input type="password" name="newpassword">
                                                                    <label>Confirm new password:</label>
                                                                    <input type="password" name="confirmpassword">
                                                                </div>
                                                            </div>
                                                        </fieldset>
                                                        <div class="btn-wrapper">
                                                            <button type="submit" class="btn theme-btn-1 btn-effect-1 text-uppercase">Save Changes</button>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- PRODUCT TAB AREA END -->
                </div>
            </div>
        </div>
    </div>
    <!-- WISHLIST AREA START -->

    {% include "components/user/feature.html" %}
    {% include "components/user/footer.html" %}

    <script>
        window.onload = function() {
          const hash = window.location.hash
            console.log(hash);
            const targetTabContent = document.getElementById(hash);
            targetTabContent.click();
            window.scrollTo(0, 0);
          }
      </script>

{% endblock content %}

